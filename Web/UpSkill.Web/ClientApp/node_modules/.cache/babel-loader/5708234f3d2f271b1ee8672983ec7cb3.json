{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.composeAndValidate = void 0;\n\nconst compose_1 = require(\"./compose\");\n\nconst validate_1 = require(\"./validate\");\n\nconst normalize_1 = require(\"./normalize\");\n\nconst utils_1 = require(\"./utils\");\n\nfunction composeAndValidate(serviceList) {\n  const errors = validate_1.validateServicesBeforeNormalization(serviceList);\n  const normalizedServiceList = serviceList.map(({\n    typeDefs,\n    ...rest\n  }) => ({\n    typeDefs: normalize_1.normalizeTypeDefs(typeDefs),\n    ...rest\n  }));\n  errors.push(...validate_1.validateServicesBeforeComposition(normalizedServiceList));\n  const compositionResult = compose_1.composeServices(normalizedServiceList);\n\n  if (utils_1.compositionHasErrors(compositionResult)) {\n    errors.push(...compositionResult.errors);\n  }\n\n  errors.push(...validate_1.validateComposedSchema({\n    schema: compositionResult.schema,\n    serviceList\n  }));\n\n  if (errors.length > 0) {\n    return {\n      schema: compositionResult.schema,\n      errors\n    };\n  } else {\n    return compositionResult;\n  }\n}\n\nexports.composeAndValidate = composeAndValidate;","map":{"version":3,"sources":["../../src/composition/composeAndValidate.ts"],"names":[],"mappings":";;;;;;;AAAA,MAAA,SAAA,GAAA,OAAA,CAAA,WAAA,CAAA;;AACA,MAAA,UAAA,GAAA,OAAA,CAAA,YAAA,CAAA;;AAMA,MAAA,WAAA,GAAA,OAAA,CAAA,aAAA,CAAA;;AACA,MAAA,OAAA,GAAA,OAAA,CAAA,SAAA,CAAA;;AAEA,SAAgB,kBAAhB,CACE,WADF,EACkC;AAEhC,QAAM,MAAM,GAAG,UAAA,CAAA,mCAAA,CAAoC,WAApC,CAAf;AAEA,QAAM,qBAAqB,GAAG,WAAW,CAAC,GAAZ,CAAgB,CAAC;AAAE,IAAA,QAAF;AAAY,OAAG;AAAf,GAAD,MAA4B;AACxE,IAAA,QAAQ,EAAE,WAAA,CAAA,iBAAA,CAAkB,QAAlB,CAD8D;AAExE,OAAG;AAFqE,GAA5B,CAAhB,CAA9B;AAMA,EAAA,MAAM,CAAC,IAAP,CAAY,GAAG,UAAA,CAAA,iCAAA,CAAkC,qBAAlC,CAAf;AAGA,QAAM,iBAAiB,GAAG,SAAA,CAAA,eAAA,CAAgB,qBAAhB,CAA1B;;AAEA,MAAI,OAAA,CAAA,oBAAA,CAAqB,iBAArB,CAAJ,EAA6C;AAC3C,IAAA,MAAM,CAAC,IAAP,CAAY,GAAG,iBAAiB,CAAC,MAAjC;AACD;;AAGD,EAAA,MAAM,CAAC,IAAP,CACE,GAAG,UAAA,CAAA,sBAAA,CAAuB;AACxB,IAAA,MAAM,EAAE,iBAAiB,CAAC,MADF;AAExB,IAAA;AAFwB,GAAvB,CADL;;AAOA,MAAI,MAAM,CAAC,MAAP,GAAgB,CAApB,EAAuB;AACrB,WAAO;AACL,MAAA,MAAM,EAAE,iBAAiB,CAAC,MADrB;AAEL,MAAA;AAFK,KAAP;AAID,GALD,MAKO;AACL,WAAO,iBAAP;AACD;AACF;;AApCD,OAAA,CAAA,kBAAA,GAAA,kBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.composeAndValidate = void 0;\nconst compose_1 = require(\"./compose\");\nconst validate_1 = require(\"./validate\");\nconst normalize_1 = require(\"./normalize\");\nconst utils_1 = require(\"./utils\");\nfunction composeAndValidate(serviceList) {\n    const errors = validate_1.validateServicesBeforeNormalization(serviceList);\n    const normalizedServiceList = serviceList.map(({ typeDefs, ...rest }) => ({\n        typeDefs: normalize_1.normalizeTypeDefs(typeDefs),\n        ...rest\n    }));\n    errors.push(...validate_1.validateServicesBeforeComposition(normalizedServiceList));\n    const compositionResult = compose_1.composeServices(normalizedServiceList);\n    if (utils_1.compositionHasErrors(compositionResult)) {\n        errors.push(...compositionResult.errors);\n    }\n    errors.push(...validate_1.validateComposedSchema({\n        schema: compositionResult.schema,\n        serviceList,\n    }));\n    if (errors.length > 0) {\n        return {\n            schema: compositionResult.schema,\n            errors,\n        };\n    }\n    else {\n        return compositionResult;\n    }\n}\nexports.composeAndValidate = composeAndValidate;\n//# sourceMappingURL=composeAndValidate.js.map"]},"metadata":{},"sourceType":"script"}