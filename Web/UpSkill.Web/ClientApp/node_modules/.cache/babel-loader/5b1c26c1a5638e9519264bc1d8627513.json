{"ast":null,"code":"const _ETA = require('./eta');\n\nconst _Terminal = require('./terminal');\n\nconst _formatter = require('./formatter');\n\nconst _EventEmitter = require('events'); // Progress-Bar constructor\n\n\nmodule.exports = class GenericBar extends _EventEmitter {\n  constructor(options) {\n    super(); // store options\n\n    this.options = options; // store terminal instance\n\n    this.terminal = this.options.terminal ? this.options.terminal : new _Terminal(this.options.stream); // the current bar value\n\n    this.value = 0; // the end value of the bar\n\n    this.total = 100; // last drawn string - only render on change!\n\n    this.lastDrawnString = null; // start time (used for eta calculation)\n\n    this.startTime = null; // stop time (used for duration calculation)\n\n    this.stopTime = null; // last update time\n\n    this.lastRedraw = Date.now(); // default eta calculator (will be re-create on start)\n\n    this.eta = new _ETA(this.options.etaBufferLength, 0, 0); // payload data\n\n    this.payload = {}; // progress bar active ?\n\n    this.isActive = false; // use default formatter or custom one ?\n\n    this.formatter = typeof this.options.format === 'function' ? this.options.format : _formatter;\n  } // internal render function\n\n\n  render() {\n    // calculate the normalized current progress\n    let progress = this.value / this.total; // handle NaN Errors caused by total=0. Set to complete in this case\n\n    if (isNaN(progress)) {\n      progress = this.options && this.options.emptyOnZero ? 0.0 : 1.0;\n    } // limiter\n\n\n    progress = Math.min(Math.max(progress, 0.0), 1.0); // formatter params\n\n    const params = {\n      progress: progress,\n      eta: this.eta.getTime(),\n      startTime: this.startTime,\n      stopTime: this.stopTime,\n      total: this.total,\n      value: this.value,\n      maxWidth: this.terminal.getWidth()\n    }; // automatic eta update ? (long running processes)\n\n    if (this.options.etaAsynchronousUpdate) {\n      this.updateETA();\n    } // format string\n\n\n    const s = this.formatter(this.options, params, this.payload);\n    const forceRedraw = this.options.forceRedraw // force redraw in notty-mode!\n    || this.options.noTTYOutput && !this.terminal.isTTY(); // string changed ? only trigger redraw on change!\n\n    if (forceRedraw || this.lastDrawnString != s) {\n      // trigger event\n      this.emit('redraw-pre'); // set cursor to start of line\n\n      this.terminal.cursorTo(0, null); // write output\n\n      this.terminal.write(s); // clear to the right from cursor\n\n      this.terminal.clearRight(); // store string\n\n      this.lastDrawnString = s; // set last redraw time\n\n      this.lastRedraw = Date.now(); // trigger event\n\n      this.emit('redraw-post');\n    }\n  } // start the progress bar\n\n\n  start(total, startValue, payload) {\n    // set initial values\n    this.value = startValue || 0;\n    this.total = typeof total !== 'undefined' && total >= 0 ? total : 100; // store payload (optional)\n\n    this.payload = payload || {}; // store start time for duration+eta calculation\n\n    this.startTime = Date.now(); // reset stop time for 're-start' scenario (used for duration calculation)\n\n    this.stopTime = null; // reset string line buffer (redraw detection)\n\n    this.lastDrawnString = ''; // initialize eta buffer\n\n    this.eta = new _ETA(this.options.etaBufferLength, this.startTime, this.value); // set flag\n\n    this.isActive = true; // start event\n\n    this.emit('start', total, startValue);\n  } // stop the bar\n\n\n  stop() {\n    // set flag\n    this.isActive = false; // store stop timestamp to get total duration\n\n    this.stopTime = Date.now(); // stop event\n\n    this.emit('stop', this.total, this.value);\n  } // update the bar value\n  // update(value, payload)\n  // update(payload)\n\n\n  update(arg0, arg1 = {}) {\n    // value set ?\n    // update(value, [payload]);\n    if (typeof arg0 === 'number') {\n      // update value\n      this.value = arg0; // add new value; recalculate eta\n\n      this.eta.update(Date.now(), arg0, this.total);\n    } // extract payload\n    // update(value, payload)\n    // update(payload)\n\n\n    const payloadData = (typeof arg0 === 'object' ? arg0 : arg1) || {}; // update event (before stop() is called)\n\n    this.emit('update', this.total, this.value); // merge payload\n\n    for (const key in payloadData) {\n      this.payload[key] = payloadData[key];\n    } // limit reached ? autostop set ?\n\n\n    if (this.value >= this.getTotal() && this.options.stopOnComplete) {\n      this.stop();\n    }\n  } // update the bar value\n  // increment(delta, payload)\n  // increment(payload)\n\n\n  increment(arg0 = 1, arg1 = {}) {\n    // increment([payload]) => step=1\n    // handle the use case when `step` is omitted but payload is passed\n    if (typeof arg0 === 'object') {\n      this.update(this.value + 1, arg0); // increment([step=1], [payload={}])\n    } else {\n      this.update(this.value + arg0, arg1);\n    }\n  } // get the total (limit) value\n\n\n  getTotal() {\n    return this.total;\n  } // set the total (limit) value\n\n\n  setTotal(total) {\n    if (typeof total !== 'undefined' && total >= 0) {\n      this.total = total;\n    }\n  } // force eta calculation update (long running processes)\n\n\n  updateETA() {\n    // add new value; recalculate eta\n    this.eta.update(Date.now(), this.value, this.total);\n  }\n\n};","map":{"version":3,"sources":["H:/Programming Repositories/Titans/Web/UpSkill.Web/ClientApp/node_modules/cli-progress/lib/generic-bar.js"],"names":["_ETA","require","_Terminal","_formatter","_EventEmitter","module","exports","GenericBar","constructor","options","terminal","stream","value","total","lastDrawnString","startTime","stopTime","lastRedraw","Date","now","eta","etaBufferLength","payload","isActive","formatter","format","render","progress","isNaN","emptyOnZero","Math","min","max","params","getTime","maxWidth","getWidth","etaAsynchronousUpdate","updateETA","s","forceRedraw","noTTYOutput","isTTY","emit","cursorTo","write","clearRight","start","startValue","stop","update","arg0","arg1","payloadData","key","getTotal","stopOnComplete","increment","setTotal"],"mappings":"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","sourcesContent":["const _ETA = require('./eta');\nconst _Terminal = require('./terminal');\nconst _formatter = require('./formatter');\nconst _EventEmitter = require('events');\n\n// Progress-Bar constructor\nmodule.exports = class GenericBar extends _EventEmitter{\n\n    constructor(options){\n        super();\n\n        // store options\n        this.options = options;\n\n        // store terminal instance\n        this.terminal = (this.options.terminal) ? this.options.terminal : new _Terminal(this.options.stream);\n\n        // the current bar value\n        this.value = 0;\n\n        // the end value of the bar\n        this.total = 100;\n\n        // last drawn string - only render on change!\n        this.lastDrawnString = null;\n\n        // start time (used for eta calculation)\n        this.startTime = null;\n\n        // stop time (used for duration calculation)\n        this.stopTime = null;\n\n        // last update time\n        this.lastRedraw = Date.now();\n\n        // default eta calculator (will be re-create on start)\n        this.eta = new _ETA(this.options.etaBufferLength, 0, 0);\n\n        // payload data\n        this.payload = {};\n\n        // progress bar active ?\n        this.isActive = false;\n\n        // use default formatter or custom one ?\n        this.formatter = (typeof this.options.format === 'function') ? this.options.format : _formatter;\n    }\n\n    // internal render function\n    render(){\n        // calculate the normalized current progress\n        let progress = (this.value/this.total);\n\n        // handle NaN Errors caused by total=0. Set to complete in this case\n        if (isNaN(progress)){\n            progress = (this.options && this.options.emptyOnZero) ? 0.0 : 1.0;\n        }\n\n        // limiter\n        progress = Math.min(Math.max(progress, 0.0), 1.0);\n\n        // formatter params\n        const params = {\n            progress: progress,\n            eta: this.eta.getTime(),\n            startTime: this.startTime,\n            stopTime: this.stopTime,\n            total: this.total,\n            value: this.value,\n            maxWidth: this.terminal.getWidth()\n        };\n\n        // automatic eta update ? (long running processes)\n        if (this.options.etaAsynchronousUpdate){\n            this.updateETA();\n        }\n\n        // format string\n        const s = this.formatter(this.options, params, this.payload);\n\n        const forceRedraw = this.options.forceRedraw\n            // force redraw in notty-mode!\n            || (this.options.noTTYOutput && !this.terminal.isTTY());\n\n        // string changed ? only trigger redraw on change!\n        if (forceRedraw || this.lastDrawnString != s){\n            // trigger event\n            this.emit('redraw-pre');\n\n            // set cursor to start of line\n            this.terminal.cursorTo(0, null);\n\n            // write output\n            this.terminal.write(s);\n\n            // clear to the right from cursor\n            this.terminal.clearRight();\n\n            // store string\n            this.lastDrawnString = s;\n\n            // set last redraw time\n            this.lastRedraw = Date.now();\n\n            // trigger event\n            this.emit('redraw-post');\n        }\n    }\n\n    // start the progress bar\n    start(total, startValue, payload){\n        // set initial values\n        this.value = startValue || 0;\n        this.total = (typeof total !== 'undefined' && total >= 0) ? total : 100;\n\n        // store payload (optional)\n        this.payload = payload || {};\n\n        // store start time for duration+eta calculation\n        this.startTime = Date.now();\n\n        // reset stop time for 're-start' scenario (used for duration calculation)\n        this.stopTime = null;\n\n        // reset string line buffer (redraw detection)\n        this.lastDrawnString = '';\n\n        // initialize eta buffer\n        this.eta = new _ETA(this.options.etaBufferLength, this.startTime, this.value);\n\n        // set flag\n        this.isActive = true;\n\n        // start event\n        this.emit('start', total, startValue);\n    }\n\n    // stop the bar\n    stop(){\n        // set flag\n        this.isActive = false;\n        \n        // store stop timestamp to get total duration\n        this.stopTime = Date.now();\n\n        // stop event\n        this.emit('stop', this.total, this.value);\n    }\n\n    // update the bar value\n    // update(value, payload)\n    // update(payload)\n    update(arg0, arg1 = {}){\n        // value set ?\n        // update(value, [payload]);\n        if (typeof arg0 === 'number') {\n            // update value\n            this.value = arg0;\n\n            // add new value; recalculate eta\n            this.eta.update(Date.now(), arg0, this.total);\n        }\n\n        // extract payload\n        // update(value, payload)\n        // update(payload)\n        const payloadData = ((typeof arg0 === 'object') ? arg0 : arg1) || {};\n\n        // update event (before stop() is called)\n        this.emit('update', this.total, this.value);\n\n        // merge payload\n        for (const key in payloadData){\n            this.payload[key] = payloadData[key];\n        }\n\n        // limit reached ? autostop set ?\n        if (this.value >= this.getTotal() && this.options.stopOnComplete) {\n            this.stop();\n        }\n    }\n\n    // update the bar value\n    // increment(delta, payload)\n    // increment(payload)\n    increment(arg0 = 1, arg1 = {}){\n        // increment([payload]) => step=1\n        // handle the use case when `step` is omitted but payload is passed\n        if (typeof arg0 === 'object') {\n            this.update(this.value + 1, arg0);\n        \n        // increment([step=1], [payload={}])\n        }else{\n            this.update(this.value + arg0, arg1);\n        }\n    }\n\n    // get the total (limit) value\n    getTotal(){\n        return this.total;\n    }\n\n    // set the total (limit) value\n    setTotal(total){\n        if (typeof total !== 'undefined' && total >= 0){\n            this.total = total;\n        }\n    }\n\n    // force eta calculation update (long running processes)\n    updateETA(){\n        // add new value; recalculate eta\n        this.eta.update(Date.now(), this.value, this.total);\n    }\n}\n"]},"metadata":{},"sourceType":"script"}